<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bookmarklet - scrape Info Cod Fiscal (Ministerul Finanțelor)</title>
    <style>body {background-color:whitesmoke;font-family:Arial, sans-serif;} #wrapper {width:60em;margin:1em auto;text-align:center;} .bookmarklet mark {padding:1ex;border-radius:4px;cursor:move;} .bookmarklet mark.brdr:hover{border:2px dashed #66D;box-shadow:0 1px .4ex rgba(0, 0, 0, .45);background-color:rgb(255, 234, 0);} textarea {width:80%;height:150px;margin-top:20px;} .text-center {text-align:center;} .brdr {border-radius:1em;border:2px dashed #BBC;box-shadow:1px 2px .5ex rgba(0, 0, 0, .3);} hr {border-top:2px solid #DDD;}</style>
</head>

<body>
    <div id="wrapper">
        <small>scrapes <a href="https://mfinante.gov.ro/apps/infocodfiscal.html">mfinante.gov.ro/apps/infocodfiscal.html</a> to local csv</small>
        <div style="margin: 4em auto 8em auto;   ">
            <p>Drag the following link to your bookmarks bar to install the bookmarklet <br/>/ trage în bara de favorite  (<a href="https://www.google.com/search?q=how+to+install+bookmarklet" target="_blank">help</a>) </p>
                  &nbsp; <p>&emsp; <b>&rarr;</b> &emsp;
                <a href="javascript: (function () {function showError() {var errorDiv = document.createElement('div'); errorDiv.style = {position: 'fixed', top: '0', left: '0', width: '100%', backgroundColor: 'red', color: 'white', textAlign: 'center', fontSize: '20px', zIndex: '1000'} ; errorDiv.textContent = 'Sorry, some error'; document.body.prepend(errorDiv);} var jumbotron = document.querySelector('div.jumbotron > b'); var centerDiv = document.querySelector('div[align=&quot;center&quot;] > b'); if (jumbotron && jumbotron.textContent.startsWith('AGENTUL ECONOMIC CU CODUL UNIC DE IDENTIFICARE')) {var uniqueCode = jumbotron.textContent.match(/\d+/g).pop(); var containers = document.querySelectorAll('div.container'); var targetContainer; for (var i = 0; i < containers.length; i++) {if (containers[i].querySelectorAll('div.row').length >= 3) {targetContainer = containers[i]; break;}} if (!targetContainer) {showError(); return;} var rows = targetContainer.querySelectorAll('div.row'); var csvContent = 'Label,Value\n'; var companyName = ''; rows.forEach(function (row) {var cells = row.querySelectorAll('div'); if (cells.length === 2) {var label = cells[0].textContent.trim(); var value = cells[1].textContent.trim(); csvContent += `&quot;${label}&quot;,&quot;${value}&quot;\n`; if (label === 'Denumire platitor:') {companyName = value.replace(/[^a-zA-Z0-9\-_]+/g, '_');}}}); csvContent += `&quot;cif&quot;,&quot;${uniqueCode}&quot;\n`; csvContent += `&quot;companyName&quot;,&quot;${companyName}&quot;\n`; var fileName = uniqueCode + (companyName? '-' + companyName : '') + '-info.csv'; var blob = new Blob([csvContent], {type: 'text/csv;charset=utf-8;'}); var link = document.createElement('a'); link.href = URL.createObjectURL(blob); link.download = fileName; link.click();} else if (centerDiv && centerDiv.textContent.trim().startsWith('Indicatori din situaţiile financiare anuale')) {var yearMatch = centerDiv.textContent.match(/20\d{2}/); var codMatch = centerDiv.textContent.match(/cod unic\s*de identificare:\s*(\d+)/); var year = yearMatch? yearMatch[0] : 'unknown'; var cod = codMatch? codMatch[1] : 'unknown'; var table = document.querySelector('center > table[bgcolor=&quot;white&quot;]'); if (table) {var rows = table.querySelectorAll('tr'); var csv = []; rows.forEach(row => {var cells = row.querySelectorAll('td, th'); var rowCsv = Array.from(cells).map(cell => '&quot;' + cell.innerText.replace(/&quot;/g, '&quot;&quot;') + '&quot;').join(','); csv.push(rowCsv);}); var csvData = csv.join('\r\n'); csvData += `\ncod,${cod}\nan,${year}`; var blob = new Blob([csvData], {type: 'text/csv;charset=utf-8;'}); var link = document.createElement('a'); link.href = URL.createObjectURL(blob); link.download = `${cod}-${year}.csv`; link.click();} else {showError();}} else {showError();}})(); " class="bookmarklet" title="trage în bara de favorite / bookmarks"> <mark class="brdr">MF cod fiscal</mark></a>
            </p>
        </div>
<!-- <hr> -->
<p>&nbsp;</p>
    
        <video width="980" height="746" controls autoplay muted  >
            <source src="img/mfin-bookmarklet.mp4" type="video/mp4">
            </video>
        <p><br></p>
        <p>Code<br>
            <textarea readonly class="brdr" style="width: 80%; margin-top: 20px; height: 10em; max-width: 60em; font-size: 12px;">
            javascript: (function () {function showError() {var errorDiv = document.createElement('div'); errorDiv.style = {position: 'fixed', top: '0', left: '0', width: '100%', backgroundColor: 'red', color: 'white', textAlign: 'center', fontSize: '20px', zIndex: '1000'} ; errorDiv.textContent = 'Sorry, some error'; document.body.prepend(errorDiv);} var jumbotron = document.querySelector('div.jumbotron > b'); var centerDiv = document.querySelector('div[align=&quot;center&quot;] > b'); if (jumbotron && jumbotron.textContent.startsWith('AGENTUL ECONOMIC CU CODUL UNIC DE IDENTIFICARE')) {var uniqueCode = jumbotron.textContent.match(/\d+/g).pop(); var containers = document.querySelectorAll('div.container'); var targetContainer; for (var i = 0; i < containers.length; i++) {if (containers[i].querySelectorAll('div.row').length >= 3) {targetContainer = containers[i]; break;}} if (!targetContainer) {showError(); return;} var rows = targetContainer.querySelectorAll('div.row'); var csvContent = 'Label,Value\n'; var companyName = ''; rows.forEach(function (row) {var cells = row.querySelectorAll('div'); if (cells.length === 2) {var label = cells[0].textContent.trim(); var value = cells[1].textContent.trim(); csvContent += `&quot;${label}&quot;,&quot;${value}&quot;\n`; if (label === 'Denumire platitor:') {companyName = value.replace(/[^a-zA-Z0-9\-_]+/g, '_');}}}); csvContent += `&quot;cif&quot;,&quot;${uniqueCode}&quot;\n`; csvContent += `&quot;companyName&quot;,&quot;${companyName}&quot;\n`; var fileName = uniqueCode + (companyName? '-' + companyName : '') + '-info.csv'; var blob = new Blob([csvContent], {type: 'text/csv;charset=utf-8;'}); var link = document.createElement('a'); link.href = URL.createObjectURL(blob); link.download = fileName; link.click();} else if (centerDiv && centerDiv.textContent.trim().startsWith('Indicatori din situaţiile financiare anuale')) {var yearMatch = centerDiv.textContent.match(/20\d{2}/); var codMatch = centerDiv.textContent.match(/cod unic\s*de identificare:\s*(\d+)/); var year = yearMatch? yearMatch[0] : 'unknown'; var cod = codMatch? codMatch[1] : 'unknown'; var table = document.querySelector('center > table[bgcolor=&quot;white&quot;]'); if (table) {var rows = table.querySelectorAll('tr'); var csv = []; rows.forEach(row => {var cells = row.querySelectorAll('td, th'); var rowCsv = Array.from(cells).map(cell => '&quot;' + cell.innerText.replace(/&quot;/g, '&quot;&quot;') + '&quot;').join(','); csv.push(rowCsv);}); var csvData = csv.join('\r\n'); csvData += `\ncod,${cod}\nan,${year}`; var blob = new Blob([csvData], {type: 'text/csv;charset=utf-8;'}); var link = document.createElement('a'); link.href = URL.createObjectURL(blob); link.download = `${cod}-${year}.csv`; link.click();} else {showError();}} else {showError();}})(); 
            </textarea>
        </p>
 

    </div>
</body>
</html>